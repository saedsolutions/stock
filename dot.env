// PostgreSQL connection (replace with your hosted DB credentials)
const pgConfig = {
    host: 'your_host',        // e.g., 'dpg-xxxx.supabase.co'
    port: 5432,               // Default PostgreSQL port
    user: 'your_username',
    password: 'your_password',
    database: 'your_database'
};

\c stock_db
CREATE TABLE stock_data (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(10) NOT NULL,
    date DATE NOT NULL,
    open NUMERIC(15, 6),
    high NUMERIC(15, 6),
    low NUMERIC(15, 6),
    close NUMERIC(15, 6),
    volume BIGINT,
    UNIQUE(ticker, date)
);

\c stock_db
CREATE TABLE x_posts (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    text TEXT NOT NULL,
    created_at TIMESTAMP NOT NULL,
    retweets INTEGER DEFAULT 0,
    likes INTEGER DEFAULT 0,
    query VARCHAR(50) NOT NULL,
    UNIQUE(text, created_at) -- Prevent duplicate posts
);
GRANT ALL PRIVILEGES ON TABLE x_posts TO stock_user;
GRANT USAGE, SELECT ON SEQUENCE x_posts_id_seq TO stock_user;

CREATE TABLE news_stories (
    id SERIAL PRIMARY KEY,
    source VARCHAR(50) NOT NULL, -- 'Yahoo Finance' or 'Reuters'
    stock_symbol VARCHAR(10) NOT NULL, -- e.g., 'AAPL'
    title VARCHAR(255) NOT NULL,
    main_text TEXT NOT NULL,
    published_at TIMESTAMP, -- Optional, depending on availability
    url VARCHAR(255) NOT NULL,
    UNIQUE(url) -- Prevent duplicate articles
);
GRANT ALL PRIVILEGES ON TABLE news_stories TO stock_user;
GRANT USAGE, SELECT ON SEQUENCE news_stories_id_seq TO stock_user;